<!DOCTYPE html>
<html class="x-admin-sm">

  <head>
      <meta charset="UTF-8">
      <title>格子租赁信息</title>
      <meta name="renderer" content="webkit">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <!--<meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />-->
      <link rel="stylesheet" href="../../css/font.css">
      <link rel="stylesheet" href="../../css/xadmin.css">
      <script type="text/javascript" src="../../js/jquery3.2.1.min.js"></script>
      <script type="text/javascript" src="../../lib/layui/layui.js" charset="utf-8"></script>
      <script type="text/javascript" src="../../js/xadmin.js"></script>
      <script type="text/javascript" src="../../js/cookie.js"></script>
      <script type="text/javascript" src="../../js/vue.min.js"></script>
      <script type="text/javascript" src="../../js/axios.min.js"></script>
      <!--<script type="text/javascript" src="../../js/vue-paginate.js"></script>-->

      <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
      <!--[if lt IE 9]>

      <script src="../../js/html5.min.js"></script>
      <script src="../../js/respond.min.js"></script>

      <![endif]-->
  </head>

  <body>
    <div class="x-body" id="detail">

            <div class="layui-form-item">
                <label  class="layui-form-label">
                    <span class="x-red">*</span>格子铺ID
                </label>
                <div class=" layui-input-inline ">
                    <input type="text" id="id"  required="" readonly="readonly" v-model="record.gridId"
                           autocomplete="off" class="layui-input ">
                </div>

                <label  class="layui-form-label">
                    <span class="x-red">*</span>格主ID
                </label>
                <div class=" layui-input-inline ">
                    <input type="text"  required="" readonly="readonly" v-model="record.tenantId"
                           autocomplete="off" class="layui-input ">
                </div>


            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">
                    <span class="x-red">*</span>格子铺名称
                </label>
                <div class="layui-input-inline">
                    <input type="text" id="name" name="name" readonly="readonly" required="" v-model="record.gridByGridId.name"
                           autocomplete="off" class="layui-input ">
                </div>
                <label  class="layui-form-label">
                    <span class="x-red">*</span>格主姓名
                </label>
                <div class=" layui-input-inline ">
                    <input type="text"  required="" readonly="readonly" v-model="record.tenantByTenantId.name"
                           autocomplete="off" class="layui-input ">
                </div>

            </div>
            <div class="layui-form-item">
                <label  class="layui-form-label">
                    <span class="x-red">*</span>格子数量
                </label>
                <div class="layui-input-inline">
                    <input type="text" id="phone" readonly="readonly"  required="" v-model="record.gridByGridId.size"
                           autocomplete="off" class="layui-input">
                </div>
                <label  class="layui-form-label">
                    <span class="x-red">*</span>格主电话
                </label>
                <div class=" layui-input-inline ">
                    <input type="text"  required="" readonly="readonly" v-model="record.tenantByTenantId.phone"
                           autocomplete="off" class="layui-input ">
                </div>

            </div>
            <div class="layui-form-item">
                <label  class="layui-form-label">
                    <span class="x-red">*</span>挂靠商铺ID
                </label>
                <div class="layui-input-inline">
                    <input type="text" id="rate"  readonly="readonly" required="" v-model="record.gridByGridId.shopId"
                           autocomplete="off" class="layui-input ">
                </div>
                <label  class="layui-form-label">
                    <span class="x-red">*</span>租赁时间
                </label>
                <div class=" layui-input-inline ">
                    <input type="text"  required="" readonly="readonly" v-model="record.date"
                           autocomplete="off" class="layui-input ">
                </div>
            </div>
            <div class="layui-form-item">
                <label  class="layui-form-label">
                    <span class="x-red">*</span>挂靠商铺名称
                </label>
                <div class="layui-input-inline">
                    <input type="text" readonly="readonly" required="" v-model="record.gridByGridId.shopByShopId.name"
                           autocomplete="off" class="layui-input ">
                </div>
                <label  class="layui-form-label">
                    <span class="x-red">*</span>到期时间
                </label>
                <div class=" layui-input-inline ">
                    <input type="text" id="endDate" required="" readonly="readonly" v-model="record.endDate"
                           autocomplete="off" class="layui-input ">
                </div>
            </div>
            <div class="layui-form-item">
                <label  class="layui-form-label">
                    <span class="x-red">*</span>挂靠商铺地址
                </label>
                <div class="layui-input-inline">
                    <input type="text" id="" readonly="readonly" required="" v-model="record.gridByGridId.shopByShopId.address"
                           autocomplete="off" class="layui-input ">
                </div>
                <label  class="layui-form-label">
                    <span class="x-red">*</span>总租金
                </label>
                <div class=" layui-input-inline ">
                    <input type="text"  required="" readonly="readonly" v-model="record.fee"
                           autocomplete="off" class="layui-input ">
                </div>
            </div>
            <div class="layui-form-item">
                <label  class="layui-form-label">
                    <span class="x-red">*</span>挂靠商铺电话
                </label>
                <div class="layui-input-inline">
                    <input type="text"  readonly="readonly" required="" v-model="record.gridByGridId.shopByShopId.phone"
                           autocomplete="off" class="layui-input ">
                </div>
                <label  class="layui-form-label">
                    <span class="x-red">*</span>租赁记录ID
                </label>
                <div class="layui-input-inline">
                    <input type="text"  readonly="readonly" required="" v-model="record.id"
                           autocomplete="off" class="layui-input ">
                </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">
              </label>
                <label class="layui-form-label">
                </label>
              <button  class="layui-btn" @click="relieve(record)" >
                  解租
              </button>
                <button  class="layui-btn" onclick="x_admin_close()">
                    取消
                </button>
          </div>
    </div>
    <script>

        const app = new Vue({
            el: "#detail",
            data:{
                record:{
                    gridByGridId:{
                        shopByShopId:{}
                    },
                    tenantByTenantId:{}
                }
            },
            mounted() {
                const rentId = JSON.parse(sessionStorage.getItem('rentId'));
                // alert(JSON.stringify(grid));
                this.getRentRecord(rentId);
            },

            methods:{

                getRentRecord(id){
                    axios.get(urlPrefix+'/rentRecords/'+id+'?token=' + token)
                        .then((response) => {
                            this.record = response.data.data;
                        }).catch((err) => {
                        errHandler(err);


                    });
                },

                relieve(record) {
                    var now = new Date();
                    var str = "确认解除租赁吗？";
                    var end = new Date(this.record.endDate);
                    // alert(now+' '+end);
                    if (now<end) {
                        str = "租赁尚未到期，确定要提前解除租赁吗"
                    }
                    layer.confirm(str,{icon:0},function () {
                        //发异步，把数据提交
                        axios.post(urlPrefix+'/grids/relieve?token=' + token,record )
                            .then((response) => {
                                layer.alert("解除租赁成功", {icon: 6},function () {

                                    var index = parent.layer.getFrameIndex(window.name);
                                    parent.layer.close(index);

                                });

                            }).catch((err) => {
                            errHandler(err);
                            layer.alert("解除租赁失败", {icon: 5});

                        });
                    });

                }

            },
        });

  </script>

  </body>

</html>
